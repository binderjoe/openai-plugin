# Build a FastAPI app for OpenAI plugin

This is a sample repo for developing OpenAI plugin using the FastAPI framework. There are three main parts of the repo:
- Code to help setup development environment for FastAPI framework
- Code for the FastAPI app
- Code to help deploy the app on the cloud

## Code to help setup development environment

### **.devcontainer**
The `.devcontainer` folder contains files for defining a containerized development environment, specific to building this FastAPI app. It's set up in a way that makes it easy for you to use with GitHub Codespaces as well: launch a Codespace using this template, and you're ready to start developing! Learn more about devcontainers [here](https://containers.dev/).

### **.vscode**
The `.vscode` folder contains:
- `json.code-snippets` file that helps to quickly write the manifest file for the OpenAI plugin. (âœ¨ Type `manifest-openai` then press `tab` to generate a )
- `settings.json` file that helps to validate the manifest file (`ai-plugin.json`) against THIS.
- `launch.json` file that helps to customize **Run and Debug**.

## Code for the FastAPI app
To test the app, run `uvicorn main:app` in the integrated terminal, or press `F5`, and debug CRUD operations at .../docs.

- `main.py` was the plugin code generated by Copilot. Learn more about Copilot here. The prompt used here is:
   ```markdown
   Write a simple TODO app using FastAPI, that lets the user add TODOs, list their TODOs, and delete TODOs, ensuring that the app stores item_id for each todo item.
 
   Include a __main__ section which will run this app using uvicorn. The Python module where I save this code will be called main.py.
 
   In addition to the normal endpoints, include a route .wellknown/ai-plugin.json which serves (as JSON) the contents of ./ai-plugin.json, located in the same directory as main.py. Exclude this route from the OpenAPI spec, and don't serve any other static content.
   ```
- `ai-plugin.json` is a JSON manifest file that defines relevant metadata for the plugin.

## Code to help deploy the app on the cloud
This repo uses Azure Developer CLI to create two Azure Container Apps: one for the API and the other for the vector database (using Redis), then deploys the app. You can use the following commands to invoke the deployment flow:
```bash
azd login --use-device-code
azd env new {your unique env name}
azd env set BEARER_TOKEN footoken
azd env set OPENAI_API_KEY {your open ai key}
azd up
```

- `azure.yaml` describes the application for Azure Developer CLI (`azd`). Learn more about Azure Developer CLI [here](https://learn.microsoft.com/en-us/azure/developer/azure-developer-cli/overview).
- `infra` folder contains infra-as-code files (Bicep) needed to provision the Azure resource.